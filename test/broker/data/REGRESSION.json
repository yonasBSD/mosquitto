[
	{
		"group": "REGRESSIONS",
		"tests": [
			{ "name": "subscribe-unsubscribe-crash part 1", "ver":4, "expect_disconnect":false, "msgs": [
				{"type":"send", "payload":"82 r38 m1234 s9 'drash/1/#' 00 s9 'erash/2/#' 00 s9 'crash/3/#' 00"},
				{"type":"recv", "payload":"90 r5 m1234 00 00 00"},
				{"type":"send", "payload":"A2 r13 m1234 s9 'drash/1/#'"},
				{"type":"recv", "payload":"B0 r2 m1234"}
			], "comment": "Must be used with part 2 immediately after",
			"comment2": "Requires WITH_ASAN=yes"},
			{ "name": "subscribe-unsubscribe-crash part 2", "ver":4, "expect_disconnect":false, "msgs": [
				{"type":"send", "payload":"82 r14 m1234 s9 'crash/3/#' 00"},
				{"type":"recv", "payload":"90 r3 m1234 00"}
			], "comment": "https://github.com/eclipse/mosquitto/issues/2885"}
		]
	},
	{
		"group": "REGRESSIONS",
		"tests": [
			{
				"name": "mismatched-shared-normal-subscribe-unsubscribe-leak", "ver":4, "expect_disconnect":false, "msgs": [
					{"type":"send", "payload":"82 r26 m1 s21 '$share/sharename/test' 01"},
					{"type":"recv", "payload":"90 r3 m1 01"},
					{"type":"send", "payload":"82 r9 m2 s4 'test' 00"},
					{"type":"recv", "payload":"90 r3 m2 00"},
					{"type":"send", "payload":"A2 r8 m7 s4 'test'"},
					{"type":"recv", "payload":"B0 r2 m7"}
				],
				"comment": "Also part one of the next two tests"
			},
			{
				"name": "acl-check-uaf", "ver":4, "expect_disconnect":false, "msgs": [
					{"type":"send", "payload":"30 r13 s4 'test' 'payload'"}
				]
			},
			{
				"name": "shared-sub-uaf", "ver":4, "expect_disconnect":false, "msgs": [
					{"type":"send", "payload":"82 r26 m1 s21 '$share/sharename/test' 01"},
					{"type":"recv", "payload":"90 r3 m1 01"},
					{"type":"send", "payload":"82 r9 m2 s4 'test' 00"},
					{"type":"recv", "payload":"90 r3 m2 00"},
					{"type":"send", "payload":"A2 r8 m7 s4 'test'"},
					{"type":"recv", "payload":"B0 r2 m7"}
				]
			}
		]
	}
]
